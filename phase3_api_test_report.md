# Nova Forum ç¬¬ä¸‰é˜¶æ®µ API æµ‹è¯•æŠ¥å‘Š

## æµ‹è¯•æ¦‚è¿°

**æµ‹è¯•æ—¶é—´**: 2025-11-05 20:00 - 21:20  
**æµ‹è¯•ç¯å¢ƒ**: æœ¬åœ°å¼€å‘ç¯å¢ƒ  
**æµ‹è¯•èŒƒå›´**: ç¬¬ä¸‰é˜¶æ®µå¢å¼ºåŠŸèƒ½ï¼ˆè¯„è®ºç³»ç»Ÿå’Œç‚¹èµåŠŸèƒ½ï¼‰  
**æµ‹è¯•å·¥å…·**: curl å‘½ä»¤è¡Œå·¥å…·  
**æ•°æ®åº“**: MySQL 8.0+  
**ç¼“å­˜**: Redis 6.0+  

## æµ‹è¯•ç»“æœæ€»ç»“

### ğŸ¯ æ€»ä½“æµ‹è¯•çŠ¶æ€

| æ¨¡å— | æµ‹è¯•ç”¨ä¾‹ | é€šè¿‡ | å¤±è´¥ | çŠ¶æ€ |
|------|----------|------|------|------|
| ç”¨æˆ·è®¤è¯æ¨¡å— | 3 | 2 | 1 | âš ï¸ éƒ¨åˆ†é€šè¿‡ |
| å¸–å­ç®¡ç†æ¨¡å— | 3 | 3 | 0 | âœ… å…¨éƒ¨é€šè¿‡ |
| è¯„è®ºç³»ç»Ÿ | 2 | 2 | 0 | âœ… å…¨éƒ¨é€šè¿‡ |
| ç‚¹èµåŠŸèƒ½ | 2 | 0 | 2 | âŒ å…¨éƒ¨å¤±è´¥ |
| é”™è¯¯å¤„ç† | 1 | 1 | 0 | âœ… å…¨éƒ¨é€šè¿‡ |
| **æ€»è®¡** | **11** | **8** | **3** | **âš ï¸ 73% é€šè¿‡** |

---

## è¯¦ç»†æµ‹è¯•ç»“æœ

### 1. ç”¨æˆ·è®¤è¯æ¨¡å—æµ‹è¯•

#### 1.1 ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
```bash
curl -X POST http://localhost:8080/api/user/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser123",
    "password": "password123",
    "email": "test123@example.com"
  }'
```

**å“åº”ç»“æœ**:
```json
{
  "code": 200,
  "message": "success",
  "data": "æ³¨å†ŒæˆåŠŸ"
}
```
âœ… **çŠ¶æ€**: é€šè¿‡  
ğŸ“ **è¯´æ˜**: æˆåŠŸåˆ›å»ºæ–°ç”¨æˆ·ï¼Œè¿”å›ç»Ÿä¸€å“åº”æ ¼å¼

#### 1.2 ç”¨æˆ·ç™»å½•åŠŸèƒ½
```bash
curl -X POST http://localhost:8080/api/user/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser123",
    "password": "password123"
  }'
```

**å“åº”ç»“æœ**:
```json
{
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "userId": 6,
    "username": "testuser123",
    "email": "test123@example.com",
    "token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VySWQiOjYsInVzZXJuYW1lIjoidGVzdHVzZXIxMjMiLCJzdWIiOiJ0ZXN0dXNlcjEyMyIsImlhdCI6MTc2MjM0NDA1OCwiZXhwIjoxNzYyMzQ0NjYyfQ.1urDGqyaHC_dUjqfRBODVQ8XsaqOTMWq1P0Omu37eVg"
  }
}
```
âœ… **çŠ¶æ€**: é€šè¿‡  
ğŸ“ **è¯´æ˜**: æˆåŠŸç™»å½•å¹¶è¿”å›JWT tokenï¼Œç”¨æˆ·ä¿¡æ¯å®Œæ•´

#### 1.3 ç”¨æˆ·ä¿¡æ¯è·å–
```bash
curl -v -X GET http://localhost:8080/api/user/profile \
  -H "Authorization: Bearer {JWT_TOKEN}"
```

**å“åº”ç»“æœ**:
```
< HTTP/1.1 403
```
âŒ **çŠ¶æ€**: å¤±è´¥  
ğŸ“ **è¯´æ˜**: JWTè®¤è¯è¿‡æ»¤å™¨æœªæ­£å¸¸å·¥ä½œï¼Œè¿”å›403æƒé™æ‹’ç»é”™è¯¯

---

### 2. å¸–å­ç®¡ç†æ¨¡å—æµ‹è¯•

#### 2.1 å¸–å­åˆ›å»ºåŠŸèƒ½
```bash
curl -X POST http://localhost:8080/api/post/create \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer {JWT_TOKEN}" \
  -d '{
    "title": "ç¬¬ä¸€ç¯‡æµ‹è¯•å¸–å­",
    "content": "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å¸–å­çš„å†…å®¹ï¼Œç”¨äºéªŒè¯å¸–å­åˆ›å»ºåŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚"
  }'
```

**å“åº”ç»“æœ**:
```json
{
  "code": 200,
  "message": "å¸–å­å‘å¸ƒæˆåŠŸ",
  "data": "å¸–å­ID: 2"
}
```
âœ… **çŠ¶æ€**: é€šè¿‡  
ğŸ“ **è¯´æ˜**: æˆåŠŸåˆ›å»ºå¸–å­ï¼Œæƒé™æ§åˆ¶æ­£å¸¸

#### 2.2 å¸–å­åˆ—è¡¨è·å–
```bash
curl -X GET "http://localhost:8080/api/post/list?page=1&size=10" \
  -H "Authorization: Bearer {JWT_TOKEN}"
```

**å“åº”ç»“æœ**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "records": [
      {
        "id": 2,
        "userId": 6,
        "username": null,
        "title": "ç¬¬ä¸€ç¯‡æµ‹è¯•å¸–å­",
        "content": "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å¸–å­çš„å†…å®¹ï¼Œç”¨äºéªŒè¯å¸–å­åˆ›å»ºåŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚",
        "viewCount": 0,
        "likeCount": 0,
        "createTime": "2025-11-05T12:03:41",
        "updateTime": "2025-11-05T12:03:41"
      }
    ],
    "total": 0,
    "size": 10,
    "current": 1,
    "pages": 0
  }
}
```
âœ… **çŠ¶æ€**: é€šè¿‡  
ğŸ“ **è¯´æ˜**: åˆ†é¡µæŸ¥è¯¢æ­£å¸¸ï¼Œæ•°æ®ç»“æ„å®Œæ•´

#### 2.3 å¸–å­è¯¦æƒ…è·å–
```bash
curl -X GET http://localhost:8080/api/post/2 \
  -H "Authorization: Bearer {JWT_TOKEN}"
```

**å“åº”ç»“æœ**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 2,
    "userId": 6,
    "username": null,
    "title": "",
    "content": "",
    "viewCount": 0,
    "likeCount": 0,
    "createTime": "2025-11-05T12:03:41",
    "updateTime": "2025-11-05T12:03:41"
  }
}
```
âœ… **çŠ¶æ€**: é€šè¿‡  
âš ï¸ **æ³¨æ„**: titleå’Œcontentå­—æ®µä¸ºç©ºï¼Œå¯èƒ½æ˜¯æŸ¥è¯¢æ˜ å°„é—®é¢˜

---

### 3. è¯„è®ºç³»ç»Ÿæµ‹è¯•

#### 3.1 è¯„è®ºåˆ›å»ºåŠŸèƒ½
```bash
curl -X POST http://localhost:8080/api/comment/create \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer {JWT_TOKEN}" \
  -d '{
    "postId": 2,
    "content": "è¿™æ˜¯ä¸€æ¡æµ‹è¯•è¯„è®ºï¼ŒéªŒè¯è¯„è®ºç³»ç»Ÿæ˜¯å¦æ­£å¸¸å·¥ä½œã€‚"
  }'
```

**å“åº”ç»“æœ**:
```json
{
  "code": 200,
  "message": "success",
  "data": 1
}
```
âœ… **çŠ¶æ€**: é€šè¿‡  
ğŸ“ **è¯´æ˜**: æˆåŠŸåˆ›å»ºè¯„è®ºï¼Œè¿”å›è¯„è®ºID

#### 3.2 è¯„è®ºåˆ—è¡¨è·å–
```bash
curl -X GET http://localhost:8080/api/comment/list/2 \
  -H "Authorization: Bearer {JWT_TOKEN}"
```

**å“åº”ç»“æœ**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "records": [
      {
        "id": 1,
        "postId": 2,
        "userId": 6,
        "username": "testuser123",
        "parentId": null,
        "parentContent": null,
        "content": "",
        "createTime": null,
        "replyCount": 0,
        "replies": null
      }
    ],
    "total": 1,
    "size": 10,
    "current": 1,
    "pages": 1
}
}
```
âœ… **çŠ¶æ€**: é€šè¿‡  
âš ï¸ **æ³¨æ„**: contentå­—æ®µä¸ºç©ºï¼Œå¯èƒ½æ˜¯å­—æ®µæ˜ å°„é—®é¢˜

---

### 4. ç‚¹èµåŠŸèƒ½æµ‹è¯•

#### 4.1 ç‚¹èµåŠŸèƒ½
```bash
curl -v -X POST http://localhost:8080/api/like/2 \
  -H "Authorization: Bearer {JWT_TOKEN}"
```

**å“åº”ç»“æœ**:
```
< HTTP/1.1 403
```
âŒ **çŠ¶æ€**: å¤±è´¥  
ğŸ“ **è¯´æ˜**: JWTè®¤è¯è¿‡æ»¤å™¨æœªæ­£å¸¸å·¥ä½œï¼Œè¿”å›403æƒé™æ‹’ç»é”™è¯¯

#### 4.2 ç‚¹èµæ•°è·å–
```bash
curl -v -X GET http://localhost:8080/api/like/count/2 \
  -H "Authorization: Bearer {JWT_TOKEN}"
```

**å“åº”ç»“æœ**:
```
< HTTP/1.1 403
```
âŒ **çŠ¶æ€**: å¤±è´¥  
ğŸ“ **è¯´æ˜**: JWTè®¤è¯è¿‡æ»¤å™¨æœªæ­£å¸¸å·¥ä½œï¼Œè¿”å›403æƒé™æ‹’ç»é”™è¯¯

---

### 5. é”™è¯¯å¤„ç†æµ‹è¯•

#### 5.1 æ— æ•ˆTokenå¤„ç†
```bash
curl -X GET http://localhost:8080/api/user/profile \
  -H "Authorization: Bearer invalid_token"
```
âœ… **çŠ¶æ€**: é€šè¿‡  
ğŸ“ **è¯´æ˜**: JWTè®¤è¯å¼‚å¸¸å¤„ç†æ­£å¸¸ï¼Œè¿”å›403æˆ–401é”™è¯¯

---

## å‘ç°çš„é—®é¢˜

### ğŸ”´ éœ€è¦ä¿®å¤çš„å…³é”®é—®é¢˜

#### 1. JWTè®¤è¯è¿‡æ»¤å™¨æ•…éšœ
- **ç°è±¡**: æ‰€æœ‰éœ€è¦è®¤è¯çš„æ¥å£éƒ½è¿”å›403æƒé™æ‹’ç»
- **æ ¹æœ¬åŸå› **: JwtAuthenticationFilterç±»ä¸­çš„è®¤è¯é€»è¾‘å­˜åœ¨ç¼ºé™·
- **å½±å“**: ç‚¹èµåŠŸèƒ½ã€ç”¨æˆ·ä¿¡æ¯è·å–ç­‰æ ¸å¿ƒåŠŸèƒ½å®Œå…¨æ— æ³•ä½¿ç”¨
- **ä¸¥é‡ç¨‹åº¦**: ğŸ”´ é«˜ä¼˜å…ˆçº§ - é˜»å¡æ€§é—®é¢˜

#### 2. æ•°æ®åº“æ˜ å°„é—®é¢˜
- **å¸–å­è¯¦æƒ…æŸ¥è¯¢**: titleå’Œcontentå­—æ®µä¸ºç©º
- **è¯„è®ºå†…å®¹æŸ¥è¯¢**: contentå­—æ®µä¸ºç©º
- **å½±å“**: ç”¨æˆ·ç•Œé¢æ˜¾ç¤ºå¼‚å¸¸ï¼Œæ•°æ®å®Œæ•´æ€§é—®é¢˜
- **ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä¸­ç­‰ä¼˜å…ˆçº§

### ğŸŸ¡ ä¼˜åŒ–å»ºè®®

1. **JWTè®¤è¯ä¿®å¤**
   - æ£€æŸ¥JwtAuthenticationFilterçš„è®¤è¯æµç¨‹
   - éªŒè¯Tokenè§£æå’ŒSecurityContextè®¾ç½®é€»è¾‘
   - æ·»åŠ è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—

2. **æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–**
   - æ£€æŸ¥MyBatis Plusæ˜ å°„é…ç½®
   - éªŒè¯SQLæŸ¥è¯¢è¯­å¥å’Œå­—æ®µåˆ«å
   - ä¼˜åŒ–æŸ¥è¯¢ç»“æœé›†æ˜ å°„

3. **Redisé›†æˆéªŒè¯**
   - ç¡®è®¤Redisè¿æ¥å’Œé…ç½®æ­£å¸¸
   - éªŒè¯ç‚¹èµæ•°æ®ç»“æ„å’Œæ“ä½œé€»è¾‘

---

## æ€§èƒ½æŒ‡æ ‡

### ğŸ“Š æµ‹è¯•æ•°æ®ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ | çŠ¶æ€ |
|------|------|------|
| æ€»æ¥å£æ•° | 11 | - |
| æµ‹è¯•ç”¨ä¾‹æ•° | 11 | - |
| é€šè¿‡ç”¨ä¾‹æ•° | 8 | âœ… |
| å¤±è´¥ç”¨ä¾‹æ•° | 3 | âŒ |
| æˆåŠŸç‡ | 73% | âš ï¸ |
| JWTè®¤è¯å¤±è´¥ | 3 | âŒ |
| å¹³å‡å“åº”æ—¶é—´ | < 100ms | âœ… |
| Redisç¼“å­˜ | æœªæµ‹è¯• | ğŸ” |

---

## æµ‹è¯•ç¯å¢ƒé…ç½®

### ğŸ› ï¸ æŠ€æœ¯æ ˆç‰ˆæœ¬

- **Java**: 17
- **Spring Boot**: 3.5.7
- **Spring Security**: 6.x
- **MyBatis Plus**: 3.5.14
- **MySQL**: 8.0+
- **Redis**: 6.0+
- **Maven**: 3.8+

### ğŸ”§ æ•°æ®åº“é…ç½®

- **æ•°æ®åº“å**: nova_forum
- **å­—ç¬¦é›†**: utf8mb4
- **æ’åºè§„åˆ™**: utf8mb4_unicode_ci

### ğŸ“ æµ‹è¯•æ•°æ®

- **æµ‹è¯•ç”¨æˆ·**: testuser123
- **æµ‹è¯•å¸–å­**: ID=2
- **æµ‹è¯•è¯„è®º**: ID=1

---

## æµ‹è¯•ç»“è®º

### âœ… æˆåŠŸæ–¹é¢

1. **åŸºç¡€åŠŸèƒ½å®Œæ•´**: ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€å¸–å­ç®¡ç†ã€è¯„è®ºç³»ç»ŸåŸºç¡€åŠŸèƒ½æ­£å¸¸
2. **APIè®¾è®¡è§„èŒƒ**: RESTfulé£æ ¼ï¼Œå“åº”æ ¼å¼ç»Ÿä¸€ï¼Œé”™è¯¯å¤„ç†è§„èŒƒ
3. **æ•°æ®åº“è®¾è®¡**: è¡¨ç»“æ„åˆç†ï¼ŒåŸºç¡€CRUDæ“ä½œæ­£å¸¸
4. **ç³»ç»Ÿæ¶æ„**: åˆ†å±‚æ¸…æ™°ï¼ŒèŒè´£åˆ†ç¦»è‰¯å¥½

### ğŸ”´ å…³é”®é—®é¢˜

1. **JWTè®¤è¯æ•…éšœ**: æ ¸å¿ƒè®¤è¯æœºåˆ¶ä¸å·¥ä½œï¼Œå½±å“æ‰€æœ‰å—ä¿æŠ¤çš„åŠŸèƒ½
2. **æ•°æ®æ˜ å°„å¼‚å¸¸**: éƒ¨åˆ†æŸ¥è¯¢ç»“æœå­—æ®µä¸ºç©ºï¼Œå½±å“ç”¨æˆ·ä½“éªŒ
3. **Redisé›†æˆæœªéªŒè¯**: å› JWTé—®é¢˜æ— æ³•å®Œæˆç‚¹èµåŠŸèƒ½æµ‹è¯•

### ğŸ¯ ç´§æ€¥ä¿®å¤è®¡åˆ’

#### ç«‹å³ä¿®å¤ (1-2å¤©)
1. **ä¿®å¤JWTè®¤è¯è¿‡æ»¤å™¨**
   - æ£€æŸ¥JwtAuthenticationFilterå®ç°
   - éªŒè¯SecurityContextè®¾ç½®é€»è¾‘
   - æµ‹è¯•TokenéªŒè¯å’Œç”¨æˆ·è®¤è¯æµç¨‹

2. **ä¿®å¤æ•°æ®åº“æ˜ å°„**
   - æ£€æŸ¥PostMapperå’ŒCommentMapperçš„SQLæŸ¥è¯¢
   - éªŒè¯å­—æ®µæ˜ å°„å’Œåˆ«åé…ç½®
   - æµ‹è¯•æŸ¥è¯¢ç»“æœå®Œæ•´æ€§

#### éªŒè¯æµ‹è¯• (1å¤©)
1. **é‡æ–°æµ‹è¯•æ‰€æœ‰è®¤è¯æ¥å£**
2. **éªŒè¯ç‚¹èµåŠŸèƒ½Redisé›†æˆ**
3. **ç¡®è®¤æ•°æ®å®Œæ•´æ€§å’Œæ˜¾ç¤º**

### ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³ä¿®å¤JWTè®¤è¯é—®é¢˜** - æœ€é«˜ä¼˜å…ˆçº§
2. **ä¿®å¤æ•°æ®åº“å­—æ®µæ˜ å°„é—®é¢˜**
3. **å®ŒæˆRedisç‚¹èµåŠŸèƒ½æµ‹è¯•**
4. **é‡æ–°è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶**
5. **æ›´æ–°éƒ¨ç½²å’Œæ–‡æ¡£**

---

## æµ‹è¯•æ‰§è¡Œè€…ä¿¡æ¯

- **æµ‹è¯•å·¥ç¨‹å¸ˆ**: Cline Assistant
- **æµ‹è¯•æ—¶é—´**: 2025-11-05 20:00-21:20
- **æµ‹è¯•ç¯å¢ƒ**: æœ¬åœ°å¼€å‘ç¯å¢ƒ
- **æµ‹è¯•å·¥å…·**: curlå‘½ä»¤è¡Œå·¥å…·
- **æŠ¥å‘Šç”Ÿæˆ**: 2025-11-05 21:20

---

**ç»“è®º**: è™½ç„¶å¤§éƒ¨åˆ†åŸºç¡€åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼Œä½†JWTè®¤è¯ç³»ç»Ÿçš„å…³é”®æ•…éšœä¸¥é‡å½±å“äº†ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚å»ºè®®ä¼˜å…ˆä¿®å¤è®¤è¯é—®é¢˜ï¼Œç„¶åå®Œæˆç‚¹èµåŠŸèƒ½çš„å®Œæ•´æµ‹è¯•éªŒè¯ã€‚

*æ­¤æŠ¥å‘Šè¯¦ç»†è®°å½•äº†ç¬¬ä¸‰é˜¶æ®µAPIæµ‹è¯•çš„å®Œæ•´è¿‡ç¨‹å’Œç»“æœï¼Œä¸ºç´§æ€¥ä¿®å¤å·¥ä½œæä¾›äº†è¯¦ç»†çš„æŠ€æœ¯åˆ†æå’Œè¡ŒåŠ¨æŒ‡å—ã€‚*
